import { describe, it } from "mocha";
import { SimpleSolver } from "./simple-solver";
import { Coordinate } from "../browser/browser";
import { expectArraysAreSame } from "./solver.spec";

describe("SimpleSolver", () => {
  it("Initial board with counts 1, 2, 3", () => {
    const solver = new SimpleSolver(13, 13);
    let cells = [
      [-1, -1, -1, -1, 1, 0, 1, -1, -1, -1, -1, -1, -1],
      [-1, -1, 2, 1, 1, 0, 2, -1, -1, -1, -1, -1, -1],
      [-1, -1, 1, 0, 0, 0, 3, -1, -1, -1, -1, -1, -1],
      [-1, -1, 1, 0, 0, 0, 2, -1, -1, -1, -1, -1, -1],
      [-1, -1, 1, 1, 0, 0, 1, 2, 2, -1, -1, -1, -1],
      [-1, -1, -1, 2, 0, 0, 0, 0, 1, -1, -1, -1, -1],
      [-1, -1, -1, 3, 1, 0, 0, 0, 1, -1, -1, -1, -1],
      [-1, -1, -1, -1, 1, 0, 0, 0, 1, 2, -1, -1, -1],
      [-1, -1, -1, -1, 2, 1, 0, 0, 0, 2, -1, -1, -1],
      [-1, -1, -1, -1, -1, 1, 1, 1, 1, 2, -1, -1, -1],
      [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
      [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
      [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
    ];

    let expectedMoves: Coordinate[] = [
      {
        x: 2,
        y: 0,
      },
      {
        x: 1,
        y: 0,
      },
      {
        x: 1,
        y: 1,
      },
      {
        x: 1,
        y: 3,
      },
      {
        x: 1,
        y: 4,
      },
      {
        x: 1,
        y: 5,
      },
      {
        x: 2,
        y: 7,
      },
      {
        x: 3,
        y: 8,
      },
      {
        x: 3,
        y: 9,
      },
      {
        x: 4,
        y: 10,
      },
      {
        x: 5,
        y: 10,
      },
      {
        x: 6,
        y: 10,
      },
      {
        x: 8,
        y: 10,
      },
      {
        x: 9,
        y: 10,
      },
      {
        x: 9,
        y: 5,
      },
      {
        x: 9,
        y: 4,
      },
      {
        x: 9,
        y: 3,
      },
      {
        x: 7,
        y: 0,
      },
    ];

    expectArraysAreSame(solver.update(cells)[0], expectedMoves);

    cells = [
      [-1, 1, 1, -1, 1, 0, 1, 1, -1, -1, -1, -1, -1],
      [-1, 2, 2, 1, 1, 0, 2, -1, -1, -1, -1, -1, -1],
      [-1, -1, 1, 0, 0, 0, 3, -1, -1, -1, -1, -1, -1],
      [-1, 1, 1, 0, 0, 0, 2, -1, -1, 4, -1, -1, -1],
      [-1, 1, 1, 1, 0, 0, 1, 2, 2, 2, -1, -1, -1],
      [-1, 2, -1, 2, 0, 0, 0, 0, 1, 1, -1, -1, -1],
      [-1, -1, -1, 3, 1, 0, 0, 0, 1, -1, -1, -1, -1],
      [-1, -1, 2, -1, 1, 0, 0, 0, 1, 2, -1, -1, -1],
      [-1, -1, -1, 3, 2, 1, 0, 0, 0, 2, -1, -1, -1],
      [-1, -1, -1, 3, -1, 1, 1, 1, 1, 2, -1, -1, -1],
      [-1, -1, -1, -1, 2, 2, 2, -1, 1, 2, -1, -1, -1],
      [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
      [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
    ];

    expectedMoves = [
      {
        x: 0,
        y: 2,
      },
      {
        x: 0,
        y: 3,
      },
      {
        x: 0,
        y: 4,
      },
      {
        x: 0,
        y: 5,
      },
      {
        x: 0,
        y: 6,
      },
      {
        x: 1,
        y: 6,
      },
      {
        x: 1,
        y: 7,
      },
      {
        x: 1,
        y: 8,
      },
      {
        x: 2,
        y: 8,
      },
      {
        x: 4,
        y: 11,
      },
      {
        x: 7,
        y: 11,
      },
      {
        x: 8,
        y: 11,
      },
      {
        x: 9,
        y: 11,
      },
      {
        x: 10,
        y: 6,
      },
      {
        x: 10,
        y: 5,
      },
      {
        x: 10,
        y: 4,
      },
      {
        x: 8,
        y: 0,
      },
      {
        x: 8,
        y: 1,
      },
    ];

    expectArraysAreSame(solver.update(cells)[0], expectedMoves);
  });
});
